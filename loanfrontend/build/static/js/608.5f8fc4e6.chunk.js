"use strict";(self.webpackChunkloan_management=self.webpackChunkloan_management||[]).push([[608],{70608:function(e,n,s){s.r(n),s.d(n,{default:function(){return Y}});var a=s(9950),l=s(82053),t=s(16491),o=s(25333),r=s(19808),d=s(93230),i=s(10226),x=s(48089),p=s(35777),c=s(55035),u=s(73062),m=s(7999),h=s(57988),A=s(48875),v=s(63464),y=s(79739),j=s(28170),f=s(6493),g=s(40033),C=s(60899),N=s(8145),E=s(7762),D=s(43939),b=s(60666),w=s(29277),F=s(25979),S=s(70006),V=s(23266),B=s(24516),z=s(4159),$=s.n(z),k=s(27702),q=s(44414);var I=e=>{const{open:n,handleClose:s,AddExpansesData:o,editExpansesData:r,UpdateExpanses:d,setEditExpansesData:x}=e,p=localStorage.getItem("user_id"),[c,u]=(0,a.useState)([]),[m,h]=(0,a.useState)([]),[A,z]=(0,a.useState)();(0,a.useEffect)((()=>{(async()=>{const e=await(0,k.x4)(`Wallet/list?createdBy=${p}`);e&&200===e.status&&u(e.data.getAllResult)})(),(async()=>{const e=await(0,k.x4)(`expansesCategories/list?createdBy=${p}`);e&&200===e.status&&h(e.data.getAllResult)})()}),[]);const I=b.Ik({expenseName:b.Yj().required("Expense Name is required"),expenseVendor:b.Yj().required("Expense Vendor is required"),expenseAmount:b.Yj().required("Expense Amount is required"),expenseFromAccount:b.Yj().required("From Account is required"),expenseCategory:b.Yj().required("Expense Category is required"),expenseDate:b.Yj().required("Expense Date is required")}),_={expenseName:r?r.expanseName:"",expenseVendor:r?r.expanseVendor:"",expenseAmount:r?r.expanseAmount:"",expenseFromAccount:r?r.expanseFromAccount:"",expenseCategory:r?r.expanseCategory:"",expenseDate:r?r.expanseDate:"",file:r?null===r||void 0===r?void 0:r.path:"",createdBy:p},Y=(0,D.Wx)({initialValues:_,validationSchema:I,enableReinitialize:!0,onSubmit:async(e,n)=>{let{resetForm:a}=n;const l={...e,file:A,fileName:null===A||void 0===A?void 0:A.name,fileType:null===A||void 0===A?void 0:A.type};r?d(l):o(l),s(),x(""),a()}});(0,a.useEffect)((()=>{z(null===r||void 0===r?void 0:r.path)}),[r]);return(0,q.jsx)("div",{children:(0,q.jsxs)(v.A,{open:n,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",children:[(0,q.jsxs)(g.A,{id:"scroll-dialog-title",style:{display:"flex",justifyContent:"space-between"},children:[(0,q.jsxs)(l.A,{variant:"h6",children:[" ",r?"Edit Expense":"Create Expense"," "]}),(0,q.jsx)(l.A,{children:(0,q.jsx)(E.A,{onClick:s,style:{cursor:"pointer"}})})]}),(0,q.jsx)(j.A,{dividers:!0,children:(0,q.jsx)("form",{children:(0,q.jsx)(f.A,{id:"scroll-dialog-description",tabIndex:-1,children:(0,q.jsxs)(C.Ay,{container:!0,rowSpacing:3,columnSpacing:{xs:0,sm:5,md:4},children:[(0,q.jsxs)(C.Ay,{item:!0,xs:12,sm:6,md:6,children:[(0,q.jsx)(w.A,{children:"Expense Name"}),(0,q.jsx)(N.A,{id:"expenseName",name:"expenseName",size:"small",fullWidth:!0,value:Y.values.expenseName,onChange:Y.handleChange,error:Y.touched.expenseName&&Boolean(Y.errors.expenseName),helperText:Y.touched.expenseName&&Y.errors.expenseName})]}),(0,q.jsxs)(C.Ay,{item:!0,xs:12,sm:6,md:6,children:[(0,q.jsx)(w.A,{children:"Expense Vendor"}),(0,q.jsx)(N.A,{id:"expenseVendor",name:"expenseVendor",size:"small",fullWidth:!0,value:Y.values.expenseVendor,onChange:Y.handleChange,error:Y.touched.expenseVendor&&Boolean(Y.errors.expenseVendor),helperText:Y.touched.expenseVendor&&Y.errors.expenseVendor})]}),(0,q.jsxs)(C.Ay,{item:!0,xs:12,sm:6,md:6,children:[(0,q.jsx)(w.A,{children:"Expense Amount"}),(0,q.jsx)(N.A,{id:"expenseAmount",name:"expenseAmount",size:"small",type:"number",fullWidth:!0,value:Y.values.expenseAmount,onChange:Y.handleChange,error:Y.touched.expenseAmount&&Boolean(Y.errors.expenseAmount),helperText:Y.touched.expenseAmount&&Y.errors.expenseAmount})]}),(0,q.jsxs)(C.Ay,{item:!0,xs:12,sm:6,md:6,children:[(0,q.jsx)(w.A,{children:"From this Account"}),(0,q.jsxs)(F.A,{fullWidth:!0,children:[(0,q.jsx)(S.A,{labelId:"demo-simple-select-label",id:"",name:"expenseFromAccount",label:"",size:"small",value:Y.values.expenseFromAccount||null,onChange:Y.handleChange,error:Y.touched.expenseFromAccount&&Boolean(Y.errors.expenseFromAccount),children:null===c||void 0===c?void 0:c.map((e=>(0,q.jsx)(V.A,{value:`${null===e||void 0===e?void 0:e._id}`,children:`${null===e||void 0===e?void 0:e.walletName}- Balance: ${null===e||void 0===e?void 0:e.addFunds}`},null===e||void 0===e?void 0:e._id)))}),(0,q.jsx)(B.A,{error:Y.touched.expenseFromAccount&&Boolean(Y.errors.expenseFromAccount),children:Y.touched.expenseFromAccount&&Y.errors.expenseFromAccount})]})]}),(0,q.jsxs)(C.Ay,{item:!0,xs:12,sm:6,md:6,children:[(0,q.jsx)(w.A,{children:"Expense Category"}),(0,q.jsxs)(F.A,{fullWidth:!0,children:[(0,q.jsx)(S.A,{labelId:"demo-simple-select-label",id:"",name:"expenseCategory",label:"",size:"small",value:Y.values.expenseCategory||null,onChange:Y.handleChange,error:Y.touched.expenseCategory&&Boolean(Y.errors.expenseCategory),children:null===m||void 0===m?void 0:m.map((e=>(0,q.jsx)(V.A,{value:`${null===e||void 0===e?void 0:e.categoryName}`,children:`${null===e||void 0===e?void 0:e.categoryName}`},null===e||void 0===e?void 0:e._id)))}),(0,q.jsx)(B.A,{error:Y.touched.expenseCategory&&Boolean(Y.errors.expenseCategory),children:Y.touched.expenseCategory&&Y.errors.expenseCategory})]})]}),(0,q.jsxs)(C.Ay,{item:!0,xs:12,md:6,children:[(0,q.jsx)(w.A,{children:"Expense Date"}),(0,q.jsx)(N.A,{name:"expenseDate",type:"date",size:"small",fullWidth:!0,value:$()(Y.values.expenseDate).format("YYYY-MM-DD"),onChange:Y.handleChange,error:Y.touched.expenseDate&&Boolean(Y.errors.expenseDate),helperText:Y.touched.expenseDate&&Y.errors.expenseDate})]}),(0,q.jsxs)(C.Ay,{item:!0,xs:12,md:12,children:[(0,q.jsx)(w.A,{children:"Expense attachment"}),(0,q.jsxs)(t.A,{component:"section",sx:{p:2,border:"1px dashed grey",textAlign:"center"},children:[(0,q.jsx)("input",{type:"file",onChange:function(e){z(e.target.files[0])},accept:"image/*,application/pdf",style:{color:"blue",cursor:"pointer"}}),r&&(0,q.jsxs)("p",{children:["Selected file: ",A&&"object"===typeof A?null===A||void 0===A?void 0:A.name:(e=>{if(!e)return"";const n=e.split("\\");return n[n.length-1]})(A)]})]})]})]})})})}),(0,q.jsxs)(y.A,{children:[(0,q.jsx)(i.A,{type:"submit",variant:"contained",onClick:Y.handleSubmit,style:{textTransform:"capitalize"},color:"secondary",children:"Save"}),(0,q.jsx)(i.A,{type:"reset",variant:"outlined",style:{textTransform:"capitalize"},onClick:()=>{Y.resetForm(),s(),x("")},color:"error",children:"Cancel"})]})]})})},_=s(20660);var Y=()=>{const e=localStorage.getItem("user_id"),[n,s]=(0,a.useState)(!1),[v,y]=(0,a.useState)(!1),[j,f]=(0,a.useState)([]),[g,C]=(0,a.useState)([]),[N,E]=(0,a.useState)(""),[D,b]=(0,a.useState)([]),w=()=>s(!0),F=()=>y(!1),S=async()=>{const n=await(0,k.x4)(`expanses/list?createdBy=${e}`);n&&200===n.status&&f(n.data.getAllResult)};(0,a.useEffect)((()=>{S(),(async()=>{const n=await(0,k.x4)(`currency/list?createdBy=${e}`);if(n&&200===n.status){const e=n.data.getAllResult.filter((e=>"active"===e.currencyStatus));b(e)}})()}),[]);const V=[{field:"_id",headerName:"S.No.",flex:.5,cellClassName:"name-column--cell name-column--cell--capitalize",renderCell:e=>e.api.getAllRowIds().indexOf(e.id)+1},{field:"expanseName",headerName:"Expense Name",flex:1,cellClassName:"name-column--cell--capitalize"},{field:"expanseVendor",headerName:"Expenses Vendor",flex:1},{field:"expanseAmount",headerName:"Expenses Amount",flex:1,renderCell:e=>{var n,s;return(0,q.jsxs)(l.A,{children:[`${null===(n=D[0])||void 0===n?void 0:n.currencySymbol} ${null===e||void 0===e||null===(s=e.row)||void 0===s?void 0:s.expanseAmount}`," "]})}},{field:"expanseCategory",headerName:"Expenses Category",flex:1},{field:"expanseDate",headerName:"Expenses Date",flex:1},{field:"action",headerName:"Action",flex:1,renderCell:e=>{const n=e=>{C(e._id),y(!0)};return(0,q.jsxs)(t.A,{children:[(0,q.jsx)(o.A,{fontSize:"40px",color:"primary",onClick:()=>{var n;n=null===e||void 0===e?void 0:e.row,E(n),w()},children:(0,q.jsx)(m.A,{})}),(0,q.jsx)(o.A,{color:"error",onClick:()=>{n(null===e||void 0===e?void 0:e.row)},children:(0,q.jsx)(h.A,{})})]})}}];return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(_.A,{openDelete:v,handleCloseDelete:F,deleteId:g,deleteData:async e=>{const n=await(0,k.Gx)(`expanses/delete/${e}`,e);n&&200===n.status&&S(),F()}}),(0,q.jsx)(I,{open:n,handleClose:()=>s(!1),AddExpansesData:async e=>{const n=new FormData;e.file&&(n.append("fileName",e.file.name),n.append("file",e.file)),n.append("expanseName",null===e||void 0===e?void 0:e.expenseName),n.append("expanseVendor",null===e||void 0===e?void 0:e.expenseVendor),n.append("expanseAmount",null===e||void 0===e?void 0:e.expenseAmount),n.append("expanseFromAccount",null===e||void 0===e?void 0:e.expenseFromAccount),n.append("expanseCategory",null===e||void 0===e?void 0:e.expenseCategory),n.append("expanseDate",null===e||void 0===e?void 0:e.expenseDate),n.append("createdBy",null===e||void 0===e?void 0:e.createdBy);const s=await(0,k.d_)("expanses/add",n);s&&200===s.status&&S()},editExpansesData:N,UpdateExpanses:async e=>{const n=new FormData;e.file&&(n.append("fileName",e.file.name),n.append("file",e.file)),n.append("expanseName",null===e||void 0===e?void 0:e.expenseName),n.append("expanseVendor",null===e||void 0===e?void 0:e.expenseVendor),n.append("expanseAmount",null===e||void 0===e?void 0:e.expenseAmount),n.append("expanseFromAccount",null===e||void 0===e?void 0:e.expenseFromAccount),n.append("expanseCategory",null===e||void 0===e?void 0:e.expenseCategory),n.append("expanseDate",null===e||void 0===e?void 0:e.expenseDate),n.append("createdBy",null===e||void 0===e?void 0:e.createdBy);const s=await(0,k.X4)(`expanses/edit/${N._id}`,n);s&&200===s.status&&S()},setEditExpansesData:E}),(0,q.jsxs)(r.A,{children:[(0,q.jsxs)(d.A,{direction:"row",alignItems:"center",mb:5,justifyContent:"space-between",children:[(0,q.jsx)(l.A,{variant:"h4",children:"Expenses Lists"}),(0,q.jsx)(d.A,{direction:"row",alignItems:"center",justifyContent:"flex-end",spacing:2,children:(0,q.jsx)(i.A,{variant:"contained",startIcon:(0,q.jsx)(A.A,{icon:"eva:plus-fill"}),onClick:w,children:"New Expense"})})]}),(0,q.jsx)(p.A,{children:(0,q.jsx)(t.A,{width:"100%",children:(0,q.jsx)(x.A,{style:{height:"600px",paddingTop:"15px"},children:(0,q.jsx)(c.zh,{rows:null!==j&&void 0!==j?j:[],columns:V,getRowId:e=>e._id,slots:{toolbar:u.O},slotProps:{toolbar:{showQuickFilter:!0}}})})})})]})]})}}}]);